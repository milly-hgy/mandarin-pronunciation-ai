/* ═══════════════════════════════════════════
   ROOT & GLOBAL
═══════════════════════════════════════════ */
:root {
  /* ── Blue & White Light Neumorphism ── */
  --bg:         #f0f4f8;   /* Soft Blue-Gray */
  --bg-light:   #f6f9fc;
  --bg-raised:  #f0f4f8;   /* Same as bg — Neumorphism requires uniform bg */

  --ink:        #1e293b;   /* Deep Navy */
  --paper:      #f0f4f8;
  --red:        #ef4444;
  --red-soft:   rgba(239,68,68,0.10);
  --gold:       #f59e0b;
  --gold-soft:  rgba(245,158,11,0.10);
  --green:      #22c55e;
  --green-soft: rgba(34,197,94,0.10);
  --blue:       #3b82f6;   /* Sky Blue accent */
  --blue-soft:  rgba(59,130,246,0.10);
  --mist:       #e2e8f0;
  --mist2:      #e8eef5;

  /* ── Legacy remaps ── */
  --navy-1: var(--bg-light);
  --navy-2: var(--mist2);
  --navy-3: var(--mist);
  --navy-4: #dde5ef;
  --navy-5: #d4dce8;
  --accent:     var(--blue);
  --accent2:    #2563eb;
  --cyan:       #06b6d4;
  --vermillion: var(--red);
  --jade:       var(--green);
  --text:       var(--ink);
  --text2:      rgba(30,41,59,0.65);
  --text3:      rgba(30,41,59,0.40);

  /* ── Light Neumorphism Shadow System ── */
  --neu-light:  rgba(255,255,255,0.85);   /* 左上亮面 */
  --neu-dark:   rgba(163,177,198,0.65);   /* 右下陰影 */
  --neu-shadow:    6px 6px 16px rgba(163,177,198,0.65), -6px -6px 16px rgba(255,255,255,0.85);
  --neu-shadow-sm: 4px 4px 10px rgba(163,177,198,0.55), -4px -4px 10px rgba(255,255,255,0.80);
  --neu-shadow-lg: 10px 10px 28px rgba(163,177,198,0.70), -10px -10px 28px rgba(255,255,255,0.90);
  --neu-inset:  inset 4px 4px 10px rgba(163,177,198,0.50), inset -4px -4px 10px rgba(255,255,255,0.75);

  /* ── Border / Glass remaps ── */
  --glass-bg:     rgba(240,244,248,0.90);
  --glass-border: rgba(30,41,59,0.08);
  --glass-shadow: var(--neu-shadow);

  --radius:    16px;
  --radius-sm: 10px;
  --radius-lg: 24px;
  --error-bg: rgba(239,68,68,0.06);
  --warn-bg:  rgba(245,158,11,0.08);
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Inter', 'Plus Jakarta Sans', sans-serif;
  background: var(--bg);
  color: var(--ink);
  min-height: 100vh;
  overflow-x: hidden;
}

/* 極細亮藍點陣紋理 */
body::before {
  content: '';
  position: fixed; inset: 0;
  background-image:
    radial-gradient(circle, rgba(59,130,246,0.04) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events: none; z-index: 0;
}

/* 角落柔光 */
body::after {
  content: '';
  position: fixed; inset: 0;
  background:
    radial-gradient(ellipse 55% 45% at 0% 0%,   rgba(59,130,246,0.06) 0%, transparent 65%),
    radial-gradient(ellipse 45% 50% at 100% 100%, rgba(6,182,212,0.04) 0%, transparent 60%);
  pointer-events: none; z-index: 0;
}

body > * { position: relative; z-index: 1; }

/* ═══════════════════════════════════════════
   NEUMORPHISM UTILITY (Light Blue-White)
═══════════════════════════════════════════ */
.glass {
  background: var(--bg);
  border: none;
  border-radius: var(--radius);
  box-shadow: var(--neu-shadow);
}

.glass-strong {
  background: var(--bg);
  border: none;
  border-radius: var(--radius);
  box-shadow: var(--neu-shadow-lg);
}

/* 通用浮雕卡片 */
.neu-card {
  background: var(--bg);
  border-radius: var(--radius);
  box-shadow: var(--neu-shadow);
}

/* 凹陷 / 按壓效果 */
.neu-inset {
  background: var(--bg);
  border-radius: var(--radius-sm);
  box-shadow: var(--neu-inset);
  border: none;
}

/* ═══════════════════════════════════════════
   HEADER
═══════════════════════════════════════════ */
header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 18px 48px;
  background: var(--bg);
  border-bottom: none;
  box-shadow: 0 4px 20px rgba(163,177,198,0.40), 0 1px 0 rgba(255,255,255,0.70);
  position: sticky; top: 0; z-index: 300;
}

.logo { display: flex; align-items: baseline; gap: 14px; }

.logo-zh {
  font-family: 'Noto Serif SC', serif;
  font-size: 26px; font-weight: 700; letter-spacing: 4px;
  background: linear-gradient(135deg, var(--accent), var(--cyan));
  -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
  position: relative;
}
.logo-zh::after {
  content: '';
  position: absolute; bottom: -3px; left: 0;
  width: 100%; height: 1.5px;
  background: linear-gradient(90deg, var(--accent), transparent);
}
.logo-en {
  font-family: 'Inter', sans-serif;
  font-size: 13px; font-style: italic; color: var(--text2); letter-spacing: 2px;
}

nav { display: flex; gap: 28px; align-items: center; }
nav a {
  font-size: 11px; letter-spacing: 2px; text-transform: uppercase;
  color: var(--text2); text-decoration: none; transition: color 0.2s;
}
nav a:hover { color: var(--text); }

.nav-cta {
  background: var(--bg);
  color: var(--accent);
  padding: 9px 22px;
  font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase;
  border: none;
  border-radius: 10px; cursor: pointer;
  font-family: 'Inter', sans-serif; font-weight: 600;
  box-shadow: var(--neu-shadow-sm);
  transition: all 0.25s;
}
.nav-cta:hover {
  box-shadow: var(--neu-shadow);
  color: var(--accent2);
}
.nav-cta:active {
  box-shadow: var(--neu-inset);
}

/* ═══════════════════════════════════════════
   HERO
═══════════════════════════════════════════ */
.hero {
  display: flex; justify-content: center; align-items: center;
  min-height: calc(100vh - 69px);
  padding: 80px 56px;
  position: relative;
}

.hero-left {
  max-width: 680px; width: 100%;
  display: flex; flex-direction: column; justify-content: center;
  align-items: flex-start;
  position: relative;
}

.hero-left::before {
  content: '声';
  font-family: 'Noto Serif SC', serif;
  font-size: 520px; font-weight: 700;
  background: linear-gradient(135deg, rgba(79,142,247,0.06), transparent);
  -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
  position: absolute; top: 50%; left: -120px; transform: translateY(-50%);
  line-height: 1; pointer-events: none; user-select: none;
}

.kicker {
  font-size: 11px; letter-spacing: 3px; text-transform: uppercase;
  color: var(--accent); margin-bottom: 20px; font-weight: 500;
  display: flex; align-items: center; gap: 10px;
}
.kicker::before {
  content: ''; width: 24px; height: 1.5px;
  background: linear-gradient(90deg, var(--accent), var(--cyan));
}

.hero-title {
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: clamp(36px, 4vw, 62px); font-weight: 800; line-height: 1.08;
  color: var(--text); margin-bottom: 24px; position: relative; z-index: 1;
}
.hero-title em { font-style: italic; font-weight: 400; background: linear-gradient(135deg, var(--accent2), var(--cyan)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }

.hero-sub {
  font-size: 14px; line-height: 1.85; color: var(--text2);
  max-width: 380px; margin-bottom: 44px; position: relative; z-index: 1;
}

.hero-actions { display: flex; gap: 14px; align-items: center; position: relative; z-index: 1; }

.btn-primary {
  background: var(--bg);
  color: var(--accent); padding: 15px 34px;
  font-family: 'Inter', sans-serif; font-size: 13px; font-weight: 700;
  letter-spacing: 1px; text-transform: uppercase;
  border: none;
  border-radius: var(--radius-sm); cursor: pointer;
  box-shadow: var(--neu-shadow);
  transition: all 0.25s; position: relative; overflow: hidden;
}
.btn-primary:hover {
  box-shadow: var(--neu-shadow-lg);
  color: var(--accent2);
  transform: translateY(-1px);
}
.btn-primary:active {
  box-shadow: var(--neu-inset);
  transform: translateY(0);
  color: var(--accent2);
}
.btn-primary span { position: relative; z-index: 1; }

.btn-ghost {
  background: var(--bg);
  border: none; color: var(--text2);
  padding: 14px 28px; font-family: 'Inter', sans-serif;
  font-size: 12px; font-weight: 500; letter-spacing: 1px; text-transform: uppercase;
  cursor: pointer; border-radius: var(--radius-sm);
  box-shadow: var(--neu-shadow-sm);
  transition: all 0.2s;
}
.btn-ghost:hover { box-shadow: var(--neu-shadow); color: var(--accent); }
.btn-ghost:active { box-shadow: var(--neu-inset); }

.stats-row { margin-top: 60px; display: flex; gap: 36px; position: relative; z-index: 1; }
.stat { display: flex; flex-direction: column; gap: 4px; }
.stat-num {
  font-family: 'Plus Jakarta Sans', sans-serif; font-size: 30px; font-weight: 800;
  background: linear-gradient(135deg, var(--accent), var(--cyan));
  -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
}
.stat-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text3); }

/* ═══════════════════════════════════════════
   HERO RIGHT — GLASS APP PANEL
═══════════════════════════════════════════ */
.hero-right {
  background: linear-gradient(160deg, var(--bg-raised) 0%, var(--bg) 100%);
  display: flex; flex-direction: column;
  position: relative; overflow: hidden;
  box-shadow: var(--neu-shadow-lg);
  border: 1px solid rgba(200,211,240,0.08);
  border-radius: var(--radius-lg);
}
.hero-right::before {
  content: '韵'; font-family: 'Noto Serif SC', serif;
  font-size: 480px; font-weight: 700;
  background: linear-gradient(135deg, rgba(79,142,247,0.06), transparent);
  -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
  position: absolute; top: 50%; right: -80px; transform: translateY(-50%);
  line-height: 1; pointer-events: none;
}

.app-shell {
  flex: 1; padding: 44px;
  display: flex; flex-direction: column; gap: 22px;
  position: relative; z-index: 1;
}

.app-header { display: flex; justify-content: space-between; align-items: center; }
.app-title { font-size: 11px; letter-spacing: 3px; text-transform: uppercase; color: var(--text3); }
.lesson-badge {
  background: linear-gradient(135deg, var(--accent), #2563eb);
  color: white; font-size: 10px; letter-spacing: 2px; padding: 5px 14px;
  text-transform: uppercase; border-radius: 20px;
  box-shadow: 0 4px 12px rgba(79,142,247,0.4);
}

.tone-display {
  text-align: center; padding: 24px 0;
  border-top: 1px solid var(--glass-border);
  border-bottom: 1px solid var(--glass-border);
}
.chinese-char { font-family: 'Noto Serif SC', serif; font-size: 64px; font-weight: 700; color: var(--text); line-height: 1; margin-bottom: 8px; }
.pinyin-text { font-family: 'DM Mono', monospace; font-size: 17px; color: var(--gold); letter-spacing: 3px; margin-bottom: 5px; }
.meaning { font-size: 11px; color: var(--text3); letter-spacing: 1px; }

/* Waveform */
.waveform-container {
  background: var(--bg);
  border: 1px solid rgba(200,211,240,0.07);
  border-radius: var(--radius-sm); padding: 18px;
  box-shadow: var(--neu-inset);
}
.waveform-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text3); margin-bottom: 12px; }
.waveform { display: flex; align-items: center; gap: 3px; height: 44px; }
.wave-bar { flex: 1; border-radius: 2px; opacity: 0.75; height: 50%; transition: height 0.22s ease; }
.wave-bar.native { background: linear-gradient(to top, var(--accent), var(--cyan)); }
.wave-bar.user { background: linear-gradient(to top, var(--vermillion), var(--gold)); }

/* Score cards */
.score-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
.score-card {
  background: var(--bg);
  border: 1px solid rgba(200,211,240,0.07);
  border-radius: var(--radius-sm); padding: 14px; text-align: center;
  transition: all 0.2s;
  box-shadow: var(--neu-shadow-sm);
}
.score-card:hover { border-color: rgba(91,156,246,0.30); transform: translateY(-2px); box-shadow: var(--neu-shadow); }
.score-value { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 26px; font-weight: 800; line-height: 1; margin-bottom: 4px; }
.score-value.good { color: var(--jade); }
.score-value.ok { color: var(--gold); }
.score-value.bad { color: var(--vermillion); }
.score-name { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--text3); }

/* Record button */
.record-area { display: flex; align-items: center; gap: 18px; }
.record-btn {
  width: 60px; height: 60px; border-radius: 50%;
  background: linear-gradient(135deg, var(--vermillion), #c0260f);
  border: none; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s; position: relative; flex-shrink: 0;
  box-shadow: 0 4px 20px rgba(232,80,58,0.5);
}
.record-btn::before {
  content: ''; position: absolute;
  width: 60px; height: 60px; border-radius: 50%;
  border: 2px solid rgba(232,80,58,0.6);
  animation: ripple 1.5s ease-out infinite;
}
.record-btn::after {
  content: ''; position: absolute;
  width: 60px; height: 60px; border-radius: 50%;
  border: 2px solid rgba(232,80,58,0.3);
  animation: ripple 1.5s ease-out infinite 0.5s;
}
@keyframes ripple { 0%{transform:scale(1);opacity:1} 100%{transform:scale(2.4);opacity:0} }
.record-btn svg { width: 20px; height: 20px; fill: white; z-index: 1; }
.record-info { flex: 1; }
.record-status { font-size: 12px; letter-spacing: 1px; color: var(--text); margin-bottom: 3px; }
.record-hint { font-size: 10px; letter-spacing: 1px; color: var(--text3); }

/* ═══════════════════════════════════════════
   FLOW STEPS
═══════════════════════════════════════════ */
.flow-steps {
  display: flex; align-items: center; padding: 18px 48px;
  background: var(--bg);
  border-bottom: none;
  box-shadow: 0 4px 14px rgba(163,177,198,0.35), 0 1px 0 rgba(255,255,255,0.70);
}
.flow-step { display: flex; align-items: center; gap: 10px; flex: 1; position: relative; }
.flow-step:not(:last-child)::after {
  content: ''; position: absolute; right: 0; top: 50%; transform: translateY(-50%);
  width: 72%; height: 1px; background: var(--glass-border); z-index: 0;
}
.step-num {
  width: 28px; height: 28px; border-radius: 50%;
  background: var(--bg); color: var(--text2);
  font-size: 11px; font-weight: 700;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; z-index: 1; transition: all 0.3s;
  box-shadow: var(--neu-shadow-sm);
}
.flow-step.active .step-num { background: var(--accent); color:white; box-shadow: 3px 3px 8px rgba(59,130,246,0.4), -3px -3px 8px rgba(255,255,255,0.8); }
.flow-step.done .step-num { background: var(--jade); color:white; box-shadow: 3px 3px 8px rgba(34,197,94,0.3), -3px -3px 8px rgba(255,255,255,0.8); }
.step-name { font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text3); white-space: nowrap; transition: color 0.3s; }
.flow-step.active .step-name { color: var(--accent); }
.flow-step.done .step-name { color: var(--jade); }

/* ═══════════════════════════════════════════
   SECTIONS — common
═══════════════════════════════════════════ */
.main-section { padding: 80px 56px; }
.section-kicker {
  font-size: 11px; letter-spacing: 3px; text-transform: uppercase;
  color: var(--accent); margin-bottom: 14px;
  display: flex; align-items: center; gap: 10px;
}
.section-kicker::before { content:''; width:20px; height:1.5px; background:linear-gradient(90deg,var(--accent),var(--cyan)); }
.section-title {
  font-family: 'Plus Jakarta Sans', sans-serif; font-size: 38px; font-weight: 800;
  line-height: 1.1; margin-bottom: 44px; color: var(--text);
}
.section-title em { font-style:italic; font-weight:400; background: linear-gradient(135deg,var(--accent2),var(--cyan)); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; }

/* ═══════════════════════════════════════════
   UPLOAD
═══════════════════════════════════════════ */
.upload-zone {
  border: 2px dashed rgba(59,130,246,0.25);
  padding: 60px 48px; text-align: center;
  cursor: pointer; transition: all 0.35s;
  position: relative; overflow: hidden;
  background: var(--bg);
  border-radius: var(--radius-lg);
  box-shadow: var(--neu-shadow);
}
.upload-zone::before {
  content: ''; position: absolute; inset: 0; border-radius: var(--radius-lg);
  background: radial-gradient(ellipse 60% 60% at 50% 50%, rgba(59,130,246,0.06), transparent);
  opacity: 0; transition: opacity 0.35s;
}
.upload-zone:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: var(--neu-shadow-lg); }
.upload-zone:hover::before { opacity: 1; }
.upload-icon {
  width: 56px; height: 56px; margin: 0 auto 20px;
  background: rgba(79,142,247,0.12); border-radius: 50%;
  display: flex; align-items: center; justify-content: center; transition: all 0.2s;
}
.upload-zone:hover .upload-icon { background: rgba(79,142,247,0.25); transform: scale(1.1); }
.upload-icon svg { width: 24px; height: 24px; stroke: var(--accent2); fill: none; stroke-width: 1.5; }
.upload-title { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 8px; color: var(--text); }
.upload-sub { font-size: 12px; color: var(--text2); letter-spacing: 0.5px; line-height: 1.7; }
input[type="file"] { display: none; }

/* ═══════════════════════════════════════════
   PROCESSING OVERLAY — with Audio Visualizer
═══════════════════════════════════════════ */
#processingOverlay {
  display: none; position: fixed; inset: 0; z-index: 600;
  background: rgba(240,244,248,0.97);
  backdrop-filter: blur(24px);
  align-items: center; justify-content: center; flex-direction: column; gap: 40px;
}
#processingOverlay.visible { display: flex; }

.proc-title-area { text-align: center; }
.proc-chinese {
  font-family: 'Noto Serif SC', serif;
  font-size: 72px; font-weight: 700;
  background: linear-gradient(135deg, var(--accent2), var(--cyan));
  -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
  animation: charReveal 0.6s ease both;
  margin-bottom: 8px;
}
@keyframes charReveal { from{opacity:0;transform:scale(0.8)} to{opacity:1;transform:scale(1)} }
.proc-subtitle { font-size: 12px; letter-spacing: 3px; text-transform: uppercase; color: var(--text3); }

/* ★ AUDIO VISUALIZER ★ */
.audio-visualizer {
  display: flex; align-items: flex-end; justify-content: center;
  gap: 4px; height: 80px; width: 320px;
}
.av-bar {
  width: 6px; border-radius: 3px;
  background: linear-gradient(to top, var(--accent), var(--cyan));
  animation: avBounce var(--dur, 0.8s) ease-in-out infinite alternate;
  transform-origin: bottom;
  box-shadow: 0 0 8px rgba(79,142,247,0.5);
}
@keyframes avBounce {
  from { transform: scaleY(0.1); opacity: 0.4; }
  to   { transform: scaleY(1);   opacity: 1;   }
}
.av-bar:nth-child(1)  { --dur:.55s; --h:30%; height:40px; animation-delay:0s; }
.av-bar:nth-child(2)  { --dur:.70s; --h:55%; height:55px; animation-delay:.08s; }
.av-bar:nth-child(3)  { --dur:.45s; --h:75%; height:72px; animation-delay:.15s; }
.av-bar:nth-child(4)  { --dur:.80s; --h:90%; height:80px; animation-delay:.06s; background: linear-gradient(to top,var(--accent),var(--jade)); }
.av-bar:nth-child(5)  { --dur:.60s; --h:100%;height:80px; animation-delay:.12s; background: linear-gradient(to top,var(--cyan),white); box-shadow:0 0 14px rgba(56,216,216,0.7); }
.av-bar:nth-child(6)  { --dur:.50s; --h:95%; height:80px; animation-delay:.04s; background: linear-gradient(to top,var(--accent),var(--jade)); }
.av-bar:nth-child(7)  { --dur:.75s; --h:80%; height:72px; animation-delay:.18s; }
.av-bar:nth-child(8)  { --dur:.65s; --h:65%; height:60px; animation-delay:.09s; }
.av-bar:nth-child(9)  { --dur:.58s; --h:50%; height:52px; animation-delay:.14s; }
.av-bar:nth-child(10) { --dur:.82s; --h:70%; height:65px; animation-delay:.03s; background: linear-gradient(to top,var(--vermillion),var(--gold)); box-shadow:0 0 8px rgba(240,180,41,0.5); }
.av-bar:nth-child(11) { --dur:.48s; --h:85%; height:78px; animation-delay:.20s; }
.av-bar:nth-child(12) { --dur:.72s; --h:60%; height:58px; animation-delay:.07s; }
.av-bar:nth-child(13) { --dur:.62s; --h:40%; height:44px; animation-delay:.16s; }
.av-bar:nth-child(14) { --dur:.85s; --h:75%; height:70px; animation-delay:.02s; }
.av-bar:nth-child(15) { --dur:.53s; --h:35%; height:36px; animation-delay:.11s; }
.av-bar:nth-child(16) { --dur:.68s; --h:55%; height:52px; animation-delay:.19s; background: linear-gradient(to top,var(--cyan),var(--accent2)); }
.av-bar:nth-child(17) { --dur:.78s; --h:80%; height:74px; animation-delay:.05s; }
.av-bar:nth-child(18) { --dur:.56s; --h:65%; height:62px; animation-delay:.13s; }
.av-bar:nth-child(19) { --dur:.90s; --h:45%; height:48px; animation-delay:.08s; }
.av-bar:nth-child(20) { --dur:.44s; --h:30%; height:38px; animation-delay:.17s; }

/* Frequency ring around visualizer */
.av-ring {
  position: absolute; width: 400px; height: 180px;
  border-radius: 50%;
  border: 1px solid rgba(79,142,247,0.15);
  animation: ringPulse 2s ease-in-out infinite;
  pointer-events: none;
}
.av-ring:nth-child(2) { width: 480px; height: 200px; animation-delay: 0.5s; border-color: rgba(56,216,216,0.08); }
@keyframes ringPulse { 0%,100%{transform:scale(1);opacity:0.6} 50%{transform:scale(1.05);opacity:1} }
.av-wrap { position: relative; display: flex; align-items: center; justify-content: center; }

.proc-steps-row { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; width: 520px; }
.proc-step {
  display: flex; align-items: center; gap: 12px;
  padding: 11px 16px;
  background: var(--bg);
  border: none;
  border-radius: var(--radius-sm);
  box-shadow: var(--neu-shadow-sm);
  opacity: 0; transform: translateY(8px);
  transition: all 0.4s ease;
}
.proc-step.visible { opacity: 1; transform: translateY(0); }
.proc-step.done { background: rgba(34,197,94,0.08); box-shadow: var(--neu-shadow-sm); }
.proc-step.active { background: rgba(59,130,246,0.08); box-shadow: var(--neu-shadow); }
.proc-dot { width: 8px; height: 8px; border-radius: 50%; background: rgba(30,41,59,0.15); flex-shrink: 0; transition: background 0.3s; }
.proc-step.active .proc-dot { background: var(--accent); animation: dotPulse 0.7s ease infinite alternate; }
.proc-step.done .proc-dot { background: var(--jade); animation: none; }
@keyframes dotPulse { from{opacity:0.4} to{opacity:1} }
.proc-text { font-size: 11px; letter-spacing: 0.5px; color: var(--text3); transition: color 0.3s; }
.proc-step.active .proc-text { color: var(--text); }
.proc-step.done .proc-text { color: var(--jade); }

/* ═══════════════════════════════════════════
   PITCH CONTOUR
═══════════════════════════════════════════ */
.contour-section { display: none; padding: 80px 56px; border-top: 1px solid var(--glass-border); }
.contour-section.visible { display: block; animation: slideIn 0.55s ease both; }
@keyframes slideIn { from{opacity:0;transform:translateY(28px)} to{opacity:1;transform:translateY(0)} }
.contour-intro { font-size: 13px; color: var(--text2); line-height: 1.85; max-width: 600px; margin-bottom: 44px; }
.contour-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

.contour-card {
  background: var(--bg);
  border: none;
  border-radius: var(--radius); overflow: hidden;
  box-shadow: var(--neu-shadow);
  transition: all 0.3s; cursor: pointer;
}
.contour-card:hover { box-shadow: var(--neu-shadow-lg); transform: translateY(-3px); }

.contour-header {
  padding: 18px 22px;
  background: rgba(255,255,255,0.50);
  border-bottom: 1px solid rgba(30,41,59,0.06);
  display: flex; align-items: center; justify-content: space-between;
}
.contour-char { font-family: 'Noto Serif SC', serif; font-size: 34px; font-weight: 700; color: var(--text); line-height: 1; }
.contour-meta { text-align: right; }
.contour-pinyin { font-size: 13px; color: var(--gold); letter-spacing: 2px; margin-bottom: 4px; }
.contour-score-badge { display: inline-block; padding: 3px 11px; font-size: 11px; letter-spacing: 1px; font-weight: 700; border-radius: 20px; }
.badge-good { background: rgba(52,216,160,0.15); color: var(--jade); border: 1px solid rgba(52,216,160,0.3); }
.badge-warn { background: rgba(240,180,41,0.15); color: var(--gold); border: 1px solid rgba(240,180,41,0.3); }
.badge-bad  { background: rgba(232,80,58,0.15);  color: var(--vermillion); border: 1px solid rgba(232,80,58,0.3); }
.contour-canvas-wrap { padding: 20px 20px 8px; }
canvas.contour-canvas { width: 100%; height: 112px; display: block; }
.contour-legend { display: flex; gap: 18px; padding: 0 20px 16px; }
.legend-item { display: flex; align-items: center; gap: 6px; font-size: 10px; letter-spacing: 1px; color: var(--text3); }
.legend-line { width: 20px; height: 2.5px; border-radius: 1px; }

/* ═══════════════════════════════════════════
   ★ SCORE BREAKDOWN ★
═══════════════════════════════════════════ */
.score-breakdown-section {
  display: none; padding: 0 56px 80px;
}
.score-breakdown-section.visible { display: block; animation: slideIn 0.6s 0.15s ease both; }

.breakdown-card {
  background: var(--bg);
  border: none; border-radius: var(--radius-lg);
  padding: 44px;
  box-shadow: var(--neu-shadow-lg);
}

.breakdown-header {
  display: flex; align-items: flex-start; justify-content: space-between;
  margin-bottom: 40px;
}
.breakdown-header-left { flex: 1; }
.bd-kicker { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--accent); margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
.bd-kicker::before { content:''; width:16px; height:1.5px; background:var(--accent); }
.bd-title { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 28px; font-weight: 800; color: var(--text); line-height: 1.1; }
.bd-sub { font-size: 12px; color: var(--text3); margin-top: 6px; letter-spacing: 0.5px; }

/* Overall score ring */
.overall-score-ring {
  display: flex; flex-direction: column; align-items: center; gap: 6px;
  flex-shrink: 0;
}
.ring-svg { width: 100px; height: 100px; transform: rotate(-90deg); }
.ring-bg { fill: none; stroke: rgba(30,41,59,0.08); stroke-width: 8; }
.ring-fill {
  fill: none; stroke-width: 8; stroke-linecap: round;
  stroke: url(#ringGrad);
  stroke-dasharray: 251.2;
  stroke-dashoffset: 251.2;
  transition: stroke-dashoffset 1.6s cubic-bezier(0.4,0,0.2,1);
}
.ring-score-text { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 22px; font-weight: 800; fill: var(--text); text-anchor: middle; transform: rotate(90deg); transform-origin: 50px 50px; }
.ring-score-label { font-size: 8px; fill: var(--text3); text-anchor: middle; transform: rotate(90deg); transform-origin: 50px 50px; letter-spacing: 1px; }
.ring-caption { font-size: 10px; color: var(--text3); letter-spacing: 2px; text-transform: uppercase; text-align: center; }

/* Category rows */
.bd-categories { display: flex; flex-direction: column; gap: 22px; }

.bd-cat {
  display: grid; grid-template-columns: 160px 1fr 80px 60px;
  align-items: center; gap: 18px;
}

.bd-cat-label { font-size: 12px; letter-spacing: 1px; color: var(--text2); }
.bd-cat-label strong { display: block; font-size: 13px; color: var(--text); font-weight: 500; margin-bottom: 2px; }

.bd-bar-track {
  height: 8px; border-radius: 4px;
  background: var(--bg); overflow: hidden; position: relative;
  box-shadow: inset 2px 2px 5px rgba(163,177,198,0.5), inset -2px -2px 5px rgba(255,255,255,0.75);
}
.bd-bar-fill {
  height: 100%; border-radius: 4px;
  width: 0;
  transition: width 1.3s cubic-bezier(0.4,0,0.2,1);
  position: relative;
}
.bd-bar-fill::after {
  content: ''; position: absolute; inset: 0; border-radius: 4px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent);
  animation: shimmer 2s ease infinite;
}
@keyframes shimmer {
  0%{transform:translateX(-100%)} 100%{transform:translateX(100%)}
}
.bd-bar-fill.col-a { background: linear-gradient(90deg, var(--jade), #1ab580); }
.bd-bar-fill.col-b { background: linear-gradient(90deg, var(--accent), var(--cyan)); }
.bd-bar-fill.col-c { background: linear-gradient(90deg, var(--gold), #f5c842); }
.bd-bar-fill.col-d { background: linear-gradient(90deg, var(--vermillion), #f07848); }

.bd-pct {
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 22px; font-weight: 800; text-align: right;
}
.bd-pct.high  { color: var(--jade); }
.bd-pct.mid   { color: var(--gold); }
.bd-pct.low   { color: var(--vermillion); }

.bd-badge {
  padding: 4px 10px; border-radius: 20px; font-size: 10px; letter-spacing: 1px;
  text-align: center; font-weight: 600; white-space: nowrap;
}
.bd-badge.mastered  { background: rgba(52,216,160,0.12); color: var(--jade); border: 1px solid rgba(52,216,160,0.25); }
.bd-badge.improving { background: rgba(240,180,41,0.12); color: var(--gold); border: 1px solid rgba(240,180,41,0.25); }
.bd-badge.focus     { background: rgba(232,80,58,0.12);  color: var(--vermillion); border: 1px solid rgba(232,80,58,0.25); }

.bd-divider { height: 1px; background: var(--glass-border); margin: 8px 0; }

/* Sub-items per category */
.bd-sub-items {
  grid-column: 1 / -1;
  display: flex; gap: 8px; flex-wrap: wrap; margin-top: 4px;
}
.bd-chip {
  padding: 4px 12px; border-radius: 20px; font-size: 10px; letter-spacing: 1px;
  border: none; color: var(--text2); background: var(--bg);
  transition: all 0.2s; cursor: pointer;
  box-shadow: 2px 2px 5px rgba(163,177,198,0.55), -2px -2px 5px rgba(255,255,255,0.80);
}
.bd-chip:hover { color: var(--accent); box-shadow: 3px 3px 7px rgba(163,177,198,0.6), -3px -3px 7px rgba(255,255,255,0.85); }
.bd-chip.error-chip { border-color: rgba(232,80,58,0.4); color: var(--vermillion); background: rgba(232,80,58,0.06); }
.bd-chip.warn-chip  { border-color: rgba(240,180,41,0.4); color: var(--gold); background: rgba(240,180,41,0.06); }

/* ═══════════════════════════════════════════
   COLOR FEEDBACK RESULTS
═══════════════════════════════════════════ */
.results-section { display: none; padding: 0 56px 80px; }
.results-section.visible { display: block; animation: slideIn 0.6s 0.2s ease both; }

.syllable-breakdown {
  margin-bottom: 44px; padding: 36px 40px;
  background: var(--bg);
  border: none; border-radius: var(--radius-lg);
  box-shadow: var(--neu-shadow);
}
.breakdown-title {
  font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--text3);
  margin-bottom: 24px; display: flex; align-items: center; gap: 10px;
}
.breakdown-title::after { content:''; flex:1; height:1px; background: var(--glass-border); }

.utterance-display { display: flex; flex-wrap: wrap; margin-bottom: 24px; }

.syllable-unit {
  display: flex; flex-direction: column; align-items: center;
  padding: 10px 14px; cursor: pointer;
  border-bottom: 3px solid transparent;
  transition: all 0.2s; position: relative;
  border-radius: var(--radius-sm) var(--radius-sm) 0 0;
}
.syllable-unit:hover { background: rgba(59,130,246,0.05); border-radius: var(--radius-sm); }
.syl-char { font-family: 'Noto Serif SC', serif; font-size: 38px; font-weight: 700; line-height: 1; }
.syl-pinyin { font-family: 'DM Mono', monospace; font-size: 11px; letter-spacing: 1px; margin-top: 4px; }

.syllable-unit.correct .syl-char { color: var(--text); }
.syllable-unit.correct .syl-pinyin { color: var(--text3); }

.syllable-unit.tone-error .syl-char { color: var(--vermillion); }
.syllable-unit.tone-error .syl-pinyin { color: var(--vermillion); text-decoration: underline; text-underline-offset: 3px; }
.syllable-unit.tone-error { border-bottom-color: var(--vermillion); background: var(--error-bg); }

.syllable-unit.initial-error .syl-char { color: var(--gold); }
.syllable-unit.initial-error .syl-pinyin { color: var(--gold); text-decoration: underline; text-underline-offset: 3px; }
.syllable-unit.initial-error { border-bottom-color: var(--gold); background: var(--warn-bg); }

.syllable-unit.vowel-error .syl-char { color: #b89af8; }
.syllable-unit.vowel-error .syl-pinyin { color: #b89af8; text-decoration: underline; text-underline-offset: 3px; }
.syllable-unit.vowel-error { border-bottom-color: #b89af8; background: rgba(184,154,248,0.08); }

.syllable-unit.compound-error .syl-char { color: var(--blue); }
.syllable-unit.compound-error .syl-pinyin { color: var(--blue); text-decoration: underline; text-underline-offset: 3px; }
.syllable-unit.compound-error { border-bottom-color: var(--blue); background: var(--blue-soft); }

.syl-tooltip {
  display: none; position: absolute; bottom: calc(100% + 8px); left: 50%; transform: translateX(-50%);
  background: var(--ink);
  border: none; color: #fff;
  padding: 8px 14px; font-size: 11px; letter-spacing: 0.5px; line-height: 1.5;
  white-space: nowrap; z-index: 50; border-radius: 8px; pointer-events: none;
  box-shadow: 4px 4px 12px rgba(163,177,198,0.5);
}
.syl-tooltip::after { content:''; position:absolute; top:100%; left:50%; transform:translateX(-50%); border:6px solid transparent; border-top-color: var(--ink); }
.syllable-unit:hover .syl-tooltip { display: block; }

.color-legend { display: flex; gap: 20px; flex-wrap: wrap; padding-top: 16px; border-top: 1px solid var(--glass-border); }
.cl-item { display: flex; align-items: center; gap: 8px; font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text3); }
.cl-swatch { width: 12px; height: 12px; border-radius: 3px; }
.cl-tone     { background: var(--red); }
.cl-initial  { background: var(--gold); }
.cl-vowel    { background: #b89af8; }
.cl-compound { background: var(--blue); }

/* Inline video push */
.inline-video-push { margin-top: 16px; padding-top: 14px; border-top: 1px solid var(--glass-border); }
.ivp-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--accent); margin-bottom: 10px; }
.ivp-cards { display: flex; gap: 10px; flex-wrap: wrap; }
.ivp-card {
  display: flex; gap: 12px; padding: 12px 14px;
  background: var(--bg); border: none;
  border-radius: var(--radius-sm); cursor: pointer; transition: all 0.2s;
  flex: 1; min-width: 200px;
  box-shadow: var(--neu-shadow-sm);
}
.ivp-card:hover { box-shadow: var(--neu-shadow); transform: translateY(-1px); }
.ivp-thumb {
  width: 44px; height: 44px; background: linear-gradient(145deg, var(--mist), var(--mist2));
  border-radius: 8px; display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; font-family: 'Noto Serif SC', serif; font-size: 16px; color: var(--text3);
  position: relative; border: none;
  box-shadow: var(--neu-shadow-sm);
}
.ivp-play-dot {
  position: absolute; bottom: -4px; right: -4px; width: 16px; height: 16px;
  background: linear-gradient(135deg, var(--accent), #2563eb);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
}
.ivp-play-dot svg { width: 6px; height: 6px; fill: white; margin-left: 1px; }
.ivp-tag { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--accent); margin-bottom: 2px; }
.ivp-title { font-size: 12px; font-weight: 500; line-height: 1.4; margin-bottom: 2px; color: var(--text); }
.ivp-meta { font-size: 10px; color: var(--text3); }

/* ── Feedback content flex fix ── */
.feedback-content { flex: 1; min-width: 0; }
.feedback-actions { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 8px; align-items: center; }
.vid-btn {
  display: inline-flex; align-items: center; gap: 5px;
  padding: 5px 12px;
  background: rgba(59,130,246,0.09); border: 1px solid rgba(59,130,246,0.22);
  border-radius: 20px; font-family: 'Inter', sans-serif;
  font-size: 10px; letter-spacing: 1px; text-transform: uppercase;
  cursor: pointer; transition: all 0.2s; color: var(--accent);
  box-shadow: none;
}
.vid-btn:hover { background: rgba(59,130,246,0.18); box-shadow: var(--neu-shadow-sm); }
.vid-btn:active { box-shadow: var(--neu-inset); transform: translateY(1px); }
.vid-btn svg { width: 9px; height: 9px; fill: var(--accent); flex-shrink: 0; }

/* ── Inline Articulatory Card ── */
.aic-card {
  background: var(--bg);
  border-radius: var(--radius);
  box-shadow: var(--neu-shadow-sm);
  overflow: hidden;
  margin-bottom: 16px;
  transition: box-shadow 0.3s;
}
.aic-header {
  padding: 12px 16px 10px;
  border-bottom: 1px solid var(--glass-border);
  display: flex; align-items: baseline; gap: 10px;
  background: linear-gradient(135deg, rgba(59,130,246,0.05), rgba(6,182,212,0.03));
}
.aic-tag  { font-size: 9px; letter-spacing: 2.5px; text-transform: uppercase; color: var(--accent); font-weight: 600; flex-shrink: 0; }
.aic-title { font-size: 12px; font-weight: 600; color: var(--text); }
.aic-body {
  display: grid; grid-template-columns: 110px 1fr;
  min-height: 130px;
}
.aic-svg-col {
  padding: 10px 8px;
  border-right: 1px solid var(--glass-border);
  display: flex; align-items: center; justify-content: center;
  background: var(--bg);
  box-shadow: inset 2px 2px 8px rgba(163,177,198,0.35), inset -2px -2px 8px rgba(255,255,255,0.65);
}
.aic-svg-col svg { width: 90px; height: auto; display: block; }
.aic-desc {
  padding: 12px 14px;
  font-size: 11px; color: var(--text2); line-height: 1.7;
}
.aic-placeholder { font-size: 11px; color: var(--text3); font-style: italic; line-height: 1.7; }
.aic-step-num { font-size: 9px; letter-spacing: 2px; color: var(--accent); text-transform: uppercase; margin-bottom: 5px; font-weight: 600; }
.aic-step-title { font-size: 12px; font-weight: 600; color: var(--text); margin-bottom: 5px; }
.aic-step-text { font-size: 11px; color: var(--text2); line-height: 1.65; }

/* ═══════════════════════════════════════════
   ANALYSIS PANEL
═══════════════════════════════════════════ */
.analysis-section {
  display: grid; grid-template-columns: 1fr 1fr; gap: 0; margin-top: 40px;
  background: var(--bg);
  border: none; border-radius: var(--radius-lg); overflow: hidden;
  box-shadow: var(--neu-shadow-lg);
}
.analysis-left { padding: 36px 40px; border-right: 1px solid var(--glass-border); }
.analysis-right { padding: 36px 40px; }
.panel-title {
  font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--text3);
  margin-bottom: 24px; display: flex; align-items: center; gap: 10px;
}
.panel-title::after { content:''; flex:1; height:1px; background:var(--glass-border); }

.tones-grid { display: flex; flex-direction: column; gap: 13px; }
.tone-row { display: grid; grid-template-columns: 40px 1fr 36px; gap: 12px; align-items: center; }
.tone-label { font-family: 'Noto Serif SC', serif; font-size: 15px; font-weight: 700; color: var(--text); }
.tone-bar-bg { height: 5px; background: var(--bg); border-radius: 3px; overflow: hidden; box-shadow: inset 1px 1px 4px rgba(163,177,198,0.5), inset -1px -1px 4px rgba(255,255,255,0.75); }
.tone-bar-fill { height: 100%; border-radius: 3px; width: 0; transition: width 1s cubic-bezier(0.4,0,0.2,1); }
.t1 { background: linear-gradient(90deg, var(--jade), #1ab580); }
.t2 { background: linear-gradient(90deg, var(--gold), #f5c842); }
.t3 { background: linear-gradient(90deg, var(--vermillion), #f07848); }
.t4 { background: linear-gradient(90deg, var(--accent), var(--cyan)); }
.t5 { background: linear-gradient(90deg, #b89af8, #8b5cf6); }
.tone-pct { font-size: 12px; color: var(--text2); text-align: right; }

.feedback-list { display: flex; flex-direction: column; gap: 12px; }
.feedback-item {
  display: flex; gap: 12px; padding: 14px;
  background: var(--bg);
  border: none; border-radius: var(--radius-sm);
  border-left: 4px solid transparent; transition: all 0.2s; cursor: pointer;
  box-shadow: var(--neu-shadow-sm);
}
.feedback-item:hover { box-shadow: var(--neu-shadow); transform: translateY(-1px); }
.feedback-item.error { border-left-color: var(--vermillion); }
.feedback-item.warning { border-left-color: var(--gold); }
.feedback-item.ok { border-left-color: var(--jade); }
.feedback-icon { width: 26px; height: 26px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 11px; }
.feedback-icon.error   { background: rgba(232,80,58,0.15); color: var(--vermillion); }
.feedback-icon.warning { background: rgba(240,180,41,0.15); color: var(--gold); }
.feedback-icon.ok      { background: rgba(52,216,160,0.15); color: var(--jade); }
.feedback-title { font-size: 12px; font-weight: 500; margin-bottom: 3px; color: var(--text); }
.feedback-desc { font-size: 11px; color: var(--text2); line-height: 1.65; letter-spacing: 0.3px; }
.anatomy-btn {
  display: inline-flex; align-items: center; gap: 6px; margin-top: 8px; padding: 5px 12px;
  background: rgba(79,142,247,0.08); border: 1px solid rgba(79,142,247,0.25);
  border-radius: 20px; font-family: 'Inter', sans-serif;
  font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase;
  cursor: pointer; color: var(--accent2); transition: all 0.2s;
}
.anatomy-btn:hover { background: rgba(79,142,247,0.2); border-color: var(--accent); }
.anatomy-btn svg { width: 11px; height: 11px; stroke: currentColor; fill: none; stroke-width: 1.5; }

.divider { width: 40px; height: 1.5px; background: linear-gradient(90deg,var(--accent),var(--cyan)); margin: 20px 0; border-radius: 1px; }

.tone-curves { display: flex; gap: 16px; margin-top: 14px; }
.tone-curve-item { display: flex; flex-direction: column; align-items: center; gap: 5px; }
.tone-svg { width: 50px; height: 38px; }
.tone-curve-label { font-size: 10px; letter-spacing: 1px; color: var(--text3); }

/* ═══════════════════════════════════════════
   VIDEO SECTION
═══════════════════════════════════════════ */
.video-section {
  padding: 80px 56px;
  background: var(--bg-raised);
  border-top: 1px solid rgba(200,211,240,0.07);
  position: relative; overflow: hidden;
}
.video-section::before {
  content: '习'; font-family: 'Noto Serif SC', serif;
  font-size: 500px; font-weight: 700;
  background: linear-gradient(135deg, rgba(79,142,247,0.04), transparent);
  -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
  position: absolute; top: 50%; right: -80px; transform: translateY(-50%);
  line-height: 1; pointer-events: none;
}
.video-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 18px; position: relative; z-index: 1; }
.video-card {
  background: var(--bg);
  border: none;
  border-radius: var(--radius); overflow: hidden;
  box-shadow: var(--neu-shadow);
  cursor: pointer; transition: all 0.3s;
}
.video-card:hover { transform: translateY(-5px); box-shadow: var(--neu-shadow-lg); }
.video-thumb {
  width: 100%; aspect-ratio: 16/9;
  background: linear-gradient(145deg, var(--mist), var(--mist2));
  position: relative; overflow: hidden;
  display: flex; align-items: center; justify-content: center;
}
.video-char { font-family: 'Noto Serif SC', serif; font-size: 60px; font-weight: 700; color: rgba(255,255,255,0.1); transition: all 0.2s; }
.video-card:hover .video-char { color: rgba(255,255,255,0.2); transform: scale(1.08); }
.video-play {
  position: absolute; width: 44px; height: 44px;
  background: linear-gradient(135deg, var(--accent), #2563eb);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  transition: transform 0.2s; box-shadow: 0 4px 16px rgba(79,142,247,0.5);
}
.video-card:hover .video-play { transform: scale(1.12); }
.video-play svg { width: 15px; height: 15px; fill: white; margin-left: 3px; }
.video-info { padding: 18px; }
.video-tag { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--accent); margin-bottom: 5px; display: block; }
.video-title { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 15px; font-weight: 700; color: var(--text); margin-bottom: 5px; line-height: 1.3; }
.video-meta { font-size: 10px; color: var(--text3); letter-spacing: 1px; }

/* ═══════════════════════════════════════════
   PROGRESS
═══════════════════════════════════════════ */
.progress-section { padding: 80px 56px; border-top: 1px solid rgba(200,211,240,0.07); }
.progress-grid {
  display: grid; grid-template-columns: repeat(4,1fr); gap: 16px; margin-top: 44px;
}
.progress-cell {
  background: var(--bg);
  border: none; border-radius: var(--radius);
  padding: 36px 28px; transition: all 0.2s;
  box-shadow: var(--neu-shadow);
}
.progress-cell:hover { transform: translateY(-2px); box-shadow: var(--neu-shadow-lg); }
.progress-num { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 44px; font-weight: 800; line-height: 1; margin-bottom: 8px; background: linear-gradient(135deg, var(--accent), var(--cyan)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
.progress-bar-wrap { height: 3px; background: var(--bg); margin-bottom: 14px; overflow: hidden; border-radius: 2px; box-shadow: inset 1px 1px 3px rgba(163,177,198,0.5), inset -1px -1px 3px rgba(255,255,255,0.75); }
.progress-bar-inner { height: 100%; background: linear-gradient(90deg, var(--accent), var(--cyan)); border-radius: 2px; }
.progress-label { font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text3); }
.progress-delta { font-size: 11px; color: var(--jade); margin-top: 4px; letter-spacing: 0.5px; }

/* ═══════════════════════════════════════════
   ANATOMY MODAL
═══════════════════════════════════════════ */
#anatomyModal {
  display: none; position: fixed; inset: 0; z-index: 900;
  background: rgba(30,41,59,0.45); backdrop-filter: blur(20px);
  align-items: center; justify-content: center; padding: 40px;
}
#anatomyModal.visible { display: flex; }
.modal-box {
  background: var(--bg);
  border: none;
  border-radius: var(--radius-lg);
  width: 100%; max-width: 820px; max-height: 90vh; overflow-y: auto;
  position: relative;
  animation: modalIn 0.35s cubic-bezier(0.34,1.56,0.64,1) both;
  box-shadow: var(--neu-shadow-lg);
}
@keyframes modalIn { from{opacity:0;transform:scale(0.9) translateY(20px)} to{opacity:1;transform:scale(1) translateY(0)} }
.modal-close {
  position: absolute; top: 18px; right: 18px; width: 34px; height: 34px;
  background: var(--bg); border: none;
  border-radius: 50%; cursor: pointer; font-size: 16px;
  display: flex; align-items: center; justify-content: center; z-index: 10;
  color: var(--text2); transition: all 0.2s;
  box-shadow: var(--neu-shadow-sm);
}
.modal-close:hover { box-shadow: var(--neu-shadow); color: var(--vermillion); }
.modal-close:hover { background: var(--vermillion); border-color: var(--vermillion); color: white; }
.modal-header {
  padding: 32px 40px 24px;
  border-bottom: 1px solid rgba(30,41,59,0.08);
  background: linear-gradient(135deg, rgba(59,130,246,0.06), rgba(6,182,212,0.04));
}
.modal-tag { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--accent); margin-bottom: 8px; }
.modal-title { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 24px; font-weight: 800; color: var(--text); line-height: 1.2; }
.modal-sub { font-size: 12px; color: var(--text3); margin-top: 7px; letter-spacing: 0.5px; }
.modal-body { padding: 36px 40px; }
.modal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 28px; }
.anatomy-svg-wrap {
  background: var(--bg);
  border: none;
  border-radius: var(--radius);
  padding: 20px; display: flex; align-items: center; justify-content: center;
  box-shadow: var(--neu-inset);
}
#anatomySvg { width: 100%; max-width: 260px; height: 280px; }
.anatomy-steps { display: flex; flex-direction: column; gap: 10px; }
.anat-step {
  display: flex; gap: 12px; padding: 12px 14px;
  border: none; border-radius: var(--radius-sm);
  border-left: 4px solid rgba(30,41,59,0.10);
  background: var(--bg); transition: all 0.2s; cursor: pointer;
  box-shadow: var(--neu-shadow-sm);
}
.anat-step.active { border-left-color: var(--accent); background: rgba(79,142,247,0.08); }
.anat-num { width: 22px; height: 22px; border-radius: 50%; background: var(--bg); display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 700; flex-shrink: 0; transition: all 0.3s; color: var(--text2); box-shadow: var(--neu-shadow-sm); }
.anat-step.active .anat-num { background: linear-gradient(135deg,var(--accent),#2563eb); color: white; }
.anat-text { font-size: 12px; line-height: 1.7; color: var(--text2); }
.anat-title { font-weight: 500; margin-bottom: 2px; font-size: 12px; color: var(--text); }
.modal-controls { display: flex; gap: 10px; margin-top: 18px; align-items: center; }
.ctrl-btn {
  padding: 9px 18px; background: var(--bg);
  color: var(--accent); border: none; border-radius: 8px; cursor: pointer;
  font-family: 'Inter', sans-serif; font-size: 11px; font-weight: 600; letter-spacing: 1px; text-transform: uppercase;
  transition: all 0.2s; box-shadow: var(--neu-shadow-sm);
}
.ctrl-btn:hover { box-shadow: var(--neu-shadow); }
.ctrl-btn:active { box-shadow: var(--neu-inset); color: var(--accent2); }
.ctrl-btn.ghost { background: var(--bg); box-shadow: var(--neu-shadow-sm); color: var(--text2); }
.ctrl-btn.ghost:hover { box-shadow: var(--neu-shadow); color: var(--accent); }
.step-indicator { font-size: 11px; color: var(--text3); margin-left: auto; }
.modal-video-link {
  margin-top: 18px; padding: 16px;
  background: linear-gradient(135deg, rgba(79,142,247,0.12), rgba(56,216,216,0.06));
  border: 1px solid rgba(79,142,247,0.25);
  border-radius: var(--radius-sm);
  display: flex; align-items: center; gap: 14px;
  cursor: pointer; transition: all 0.2s; text-decoration: none;
}
.modal-video-link:hover { border-color: var(--accent); background: rgba(79,142,247,0.2); }
.mvl-icon { width: 38px; height: 38px; border-radius: 50%; background: linear-gradient(135deg,var(--accent),#2563eb); display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 4px 12px rgba(79,142,247,0.4); }
.mvl-icon svg { width: 13px; height: 13px; fill: white; margin-left: 2px; }
.mvl-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text3); margin-bottom: 2px; }
.mvl-title { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 15px; font-weight: 700; color: var(--text); }

/* ═══════════════════════════════════════════
   FOOTER
═══════════════════════════════════════════ */
footer {
  background: var(--ink);
  border-top: none;
  box-shadow: 0 -4px 24px rgba(163,177,198,0.4);
  padding: 40px 56px;
  display: flex; justify-content: space-between; align-items: center;
  position: relative; overflow: hidden;
}
footer::before {
  content: '声韵';
  font-family: 'Noto Serif SC', serif;
  font-size: 180px; font-weight: 700; color: white; opacity: 0.05;
  position: absolute; right: -20px; top: 50%; transform: translateY(-50%);
  line-height: 1; pointer-events: none; letter-spacing: 8px;
}
footer::after {
  content: '';
  position: absolute; inset: 0;
  background: radial-gradient(ellipse 60% 100% at 0% 50%, rgba(255,255,255,0.12), transparent);
  pointer-events: none;
}
.footer-inner { display: flex; justify-content: space-between; align-items: center; width: 100%; position: relative; z-index: 1; }
.footer-brand { display: flex; flex-direction: column; gap: 6px; }
.footer-logo { font-family: 'Noto Serif SC', serif; font-size: 22px; font-weight: 700; letter-spacing: 5px; color: white; text-shadow: 0 2px 12px rgba(0,0,0,0.2); }
.footer-tagline { font-size: 11px; letter-spacing: 2px; color: rgba(255,255,255,0.7); text-transform: uppercase; }
.footer-links { display: flex; gap: 24px; }
.footer-links a { font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; color: rgba(255,255,255,0.7); text-decoration: none; transition: color 0.2s; }
.footer-links a:hover { color: white; }
.footer-copy { font-size: 11px; letter-spacing: 1px; color: rgba(255,255,255,0.55); }

/* ═══════════════════════════════════════════
   ANIMATIONS
═══════════════════════════════════════════ */
@keyframes fadeUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
.hero-left > * { animation: fadeUp 0.8s ease both; }
.hero-left > *:nth-child(1){animation-delay:.1s}
.hero-left > *:nth-child(2){animation-delay:.2s}
.hero-left > *:nth-child(3){animation-delay:.3s}
.hero-left > *:nth-child(4){animation-delay:.4s}
.hero-left > *:nth-child(5){animation-delay:.5s}

/* ═══════════════════════════════════════════
   RESPONSIVE
═══════════════════════════════════════════ */
@media(max-width:960px){
  .hero,.contour-grid,.analysis-section,.modal-grid,.bd-cat{ grid-template-columns:1fr; }
  .hero-right{ min-height:500px; }
  .analysis-left{ border-right:none; border-bottom:1px solid var(--glass-border); }
  .video-grid,.progress-grid{ grid-template-columns:1fr; }
  header,.hero-left,.app-shell,.main-section,.video-section,.contour-section,.results-section,.score-breakdown-section{ padding-left:24px; padding-right:24px; }
  nav{ display:none; }
  .bd-cat{ grid-template-columns:1fr 1fr; }
  .bd-pct,.bd-badge{ display:none; }
  .record-primary-area{ flex-direction:column; text-align:center; }
  .yt-outer{ max-width:100%; }
}

/* ═══════════════════════════════════════════
   PHONETIC HIGHLIGHT COLORS
═══════════════════════════════════════════ */
.ph-tone     { color: var(--red);  font-weight: 700; }
.ph-simple   { color: var(--gold); }
.ph-initial  { color: var(--blue); font-weight: 600; }
.ph-compound { color: var(--blue); }

/* ═══════════════════════════════════════════
   CEFR BADGE
═══════════════════════════════════════════ */
.cefr-badge {
  display: inline-flex; align-items: center; gap: 7px;
  padding: 5px 16px; border-radius: 20px;
  font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase;
  font-weight: 600; border: 1px solid; margin-top: 10px;
  transition: all 0.5s ease;
}

/* ═══════════════════════════════════════════
   TARGET SENTENCE DISPLAY
═══════════════════════════════════════════ */
.target-sentence {
  margin-top: 20px; padding: 18px 22px;
  background: var(--bg);
  border: none; border-radius: var(--radius-sm);
  border-left: 4px solid var(--accent);
  box-shadow: var(--neu-inset);
}
.ts-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text3); margin-bottom: 8px; }
.ts-text  { font-family: 'Noto Serif SC', serif; font-size: 22px; color: var(--text); letter-spacing: 3px; min-height: 32px; }

/* ═══════════════════════════════════════════
   ERROR SUMMARY
═══════════════════════════════════════════ */
.error-summary-section {
  margin-bottom: 28px; padding: 24px 28px;
  background: var(--bg);
  border: none; border-radius: var(--radius);
  box-shadow: var(--neu-shadow);
}
.es-header {
  font-size: 10px; letter-spacing: 3px; text-transform: uppercase;
  color: var(--accent); margin-bottom: 16px; display: flex; align-items: center; gap: 8px;
}
.es-header::before { content:''; width:16px; height:1.5px; background: var(--accent); }
.es-item {
  display: flex; align-items: flex-start; gap: 12px; padding: 12px 14px;
  background: var(--bg); border: none;
  border-left: 4px solid; border-radius: var(--radius-sm); margin-bottom: 8px;
  transition: all 0.2s;
  box-shadow: var(--neu-shadow-sm);
}
.es-item:last-child { margin-bottom: 0; }
.es-icon  { font-size: 16px; flex-shrink: 0; margin-top: 1px; }
.es-label { font-size: 12px; font-weight: 500; margin-bottom: 3px; }
.es-tip   { font-size: 11px; color: var(--text2); line-height: 1.65; }

/* ═══════════════════════════════════════════
   STT RECORD PRIMARY BUTTON
═══════════════════════════════════════════ */
.record-primary-area {
  display: flex; align-items: center; gap: 28px; padding: 36px 40px;
  background: var(--bg);
  border: none; border-radius: var(--radius-lg);
  margin-bottom: 20px; transition: all 0.3s; cursor: default;
  box-shadow: var(--neu-shadow);
}
.record-primary-area:hover { box-shadow: var(--neu-shadow-lg); }
.record-main-btn {
  width: 80px; height: 80px; border-radius: 50%;
  background: var(--bg);
  border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: all 0.25s; position: relative; flex-shrink: 0;
  box-shadow: var(--neu-shadow);
  color: var(--vermillion);
}
.record-main-btn:hover { box-shadow: var(--neu-shadow-lg); }
.record-main-btn:active, .record-main-btn.listening { box-shadow: var(--neu-inset); }
.record-main-btn::before {
  content:''; position:absolute; width:80px; height:80px; border-radius:50%;
  border: 2px solid rgba(239,68,68,0.4); animation: ripple 1.5s ease-out infinite;
}
.record-main-btn::after {
  content:''; position:absolute; width:80px; height:80px; border-radius:50%;
  border: 2px solid rgba(239,68,68,0.2); animation: ripple 1.5s ease-out infinite 0.5s;
}
.record-main-btn svg { width:28px; height:28px; z-index:1; stroke: currentColor; }
.record-main-btn.listening {
  background: var(--bg);
  box-shadow: var(--neu-inset);
  animation: recordPulse 0.8s ease-in-out infinite alternate;
  color: #dc2626;
}
@keyframes recordPulse { from{transform:scale(1)} to{transform:scale(1.1)} }
.rp-info   { flex: 1; }
.rp-status { font-size: 15px; font-weight: 500; color: var(--text); margin-bottom: 4px; letter-spacing: 0.5px; }
.rp-hint   { font-size: 12px; color: var(--text3); letter-spacing: 0.5px; margin-bottom: 8px; }
.rp-result { font-family: 'Noto Serif SC', serif; font-size: 20px; color: var(--accent2); letter-spacing: 3px; min-height: 28px; }
.upload-or-divider {
  display: flex; align-items: center; gap: 16px;
  font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text3);
  margin: 16px 0;
}
.upload-or-divider::before, .upload-or-divider::after {
  content:''; flex:1; height:1px; background: var(--glass-border);
}

/* ═══════════════════════════════════════════
   YOUTUBE RESPONSIVE CONTAINER
═══════════════════════════════════════════ */
.video-section {
  display: none; padding: 80px 56px;
  border-top: none;
  position: relative; overflow: hidden;
}
.video-section.visible { display: block; animation: slideIn 0.6s 0.25s ease both; }
.yt-outer { max-width: 880px; margin: 0 auto; position: relative; z-index: 1; }
.yt-caption {
  font-size: 11px; letter-spacing: 2px; color: var(--accent);
  margin-bottom: 14px; text-transform: uppercase;
  display: flex; align-items: center; gap: 8px;
}
.yt-caption::before { content:'▶'; font-size:9px; }
.yt-wrap {
  position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;
  border-radius: var(--radius-lg);
  background: linear-gradient(145deg, var(--mist), var(--mist2));
  border: none;
  box-shadow: var(--neu-shadow-lg);
}
.yt-wrap iframe {
  position: absolute; top:0; left:0; width:100%; height:100%;
  border: none; border-radius: var(--radius-lg);
}
.yt-placeholder {
  position: absolute; inset:0; display: flex; flex-direction: column;
  align-items: center; justify-content: center; gap: 14px;
  font-size: 12px; color: var(--text3); letter-spacing: 1px; text-align: center;
}
.yt-ph-icon {
  width: 60px; height: 60px; border-radius: 50%;
  background: rgba(79,142,247,0.1); border: 1px solid var(--glass-border);
  display: flex; align-items: center; justify-content: center;
}
.yt-ph-icon svg { width:22px; height:22px; fill: var(--accent2); margin-left:3px; }

/* Color legend additions */
.cl-compound { background: #7eb8ff; }

/* Phonetic legend */
.ph-legend {
  display: flex; gap: 20px; flex-wrap: wrap;
  padding-top: 16px; border-top: 1px solid var(--glass-border); margin-top: 16px;
}
.ph-leg-item { display: flex; align-items: center; gap: 7px; font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text3); }

/* ═══════════════════════════════════════════
   MOBILE — max-width: 768px
═══════════════════════════════════════════ */
@media (max-width: 768px) {
    .container {
        width: 95%;          /* 讓容器佔滿螢幕 */
        padding: 10px;       /* 縮小內距 */
        flex-direction: column; /* 如果有並排的元素，改為上下排列 */
    }

    .card-3d {
        width: 100%;         /* 讓 3D 卡片寬度自適應 */
        margin-bottom: 20px;
    }

    h1 {
        font-size: 1.5rem;   /* 縮小手機版的標題字體 */
    }
}
.ph-swatch { width: 12px; height: 12px; border-radius: 3px; }
